import{d as F,r as V,a as h,b as i,o as S,c as w,w as n,e as t,f as _,m as q,E as x,q as N,s as U,t as E,v as I,x as O}from"./index-Cxp8lBjq.js";import{g as R,s as M,p as P,d as D}from"./fieldType-a-DGnG_b.js";import"./request-C7Ncguaj.js";const K=F({__name:"add-or-edit",emits:["refreshPage"],setup(z,{expose:l,emit:v}){const m=v,c=V(!1),y=V(),r=h({id:"",columnType:"",attrType:"",packageName:"",createTime:""}),b=h({columnType:[{required:!0,message:"必填项不能为空",trigger:"blur"}],attrType:[{required:!0,message:"必填项不能为空",trigger:"blur"}]}),k=d=>{c.value=!0,r.id="",y.value&&y.value.resetFields(),d&&o(d)},o=d=>{R(d).then(a=>{Object.assign(r,a.data)})},e=()=>{y.value.validate(d=>{if(!d)return!1;M(r).then(()=>{c.value=!1,m("refreshPage"),x.success("操作成功")})})};return l({init:k}),(d,a)=>{const u=i("el-input"),g=i("el-form-item"),f=i("el-form"),T=i("el-button"),C=i("el-dialog");return S(),w(C,{modelValue:c.value,"onUpdate:modelValue":a[6]||(a[6]=s=>c.value=s),title:r.id?"修改":"新增","close-on-click-modal":!1},{footer:n(()=>[t(T,{onClick:a[4]||(a[4]=s=>c.value=!1)},{default:n(()=>[_("取消")]),_:1}),t(T,{type:"primary",onClick:a[5]||(a[5]=s=>e())},{default:n(()=>[_("确定")]),_:1})]),default:n(()=>[t(f,{ref_key:"dataFormRef",ref:y,model:r,rules:b,"label-width":"120",onKeyup:a[3]||(a[3]=q(s=>e(),["enter"]))},{default:n(()=>[t(g,{label:"字段类型",prop:"columnType"},{default:n(()=>[t(u,{modelValue:r.columnType,"onUpdate:modelValue":a[0]||(a[0]=s=>r.columnType=s),placeholder:"字段类型"},null,8,["modelValue"])]),_:1}),t(g,{label:"属性类型",prop:"attrType"},{default:n(()=>[t(u,{modelValue:r.attrType,"onUpdate:modelValue":a[1]||(a[1]=s=>r.attrType=s),placeholder:"属性类型"},null,8,["modelValue"])]),_:1}),t(g,{label:"属性包名",prop:"packageName"},{default:n(()=>[t(u,{modelValue:r.packageName,"onUpdate:modelValue":a[2]||(a[2]=s=>r.packageName=s),placeholder:"属性包名"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),H=F({__name:"index",setup(z){const l=h({queryForm:{columnType:"",attrType:"",packageName:""},page:{current:1,pageSize:10,total:0,orderItems:[{column:"createTime",asc:!1}]},data:[],dataSelections:[],loading:!1}),v=V();N(()=>{m()});const m=(o=1,e)=>{l.page.current=o,e!==void 0&&(l.page.pageSize=e),l.loading=!0;const d={current:l.page.current,pageSize:l.page.pageSize,orderItems:l.page.orderItems,...l.queryForm};P(d).then(a=>{const{list:u,total:g}=a.data;l.data=u,l.page.total=g}),l.loading=!1},c=o=>{m(1,o)},y=o=>{m(o)},r=o=>{v.value.init(o)},b=o=>{let e=[];if(o)e=[o];else if(e=l.dataSelections?l.dataSelections:[],e.length===0){x.warning("请选择删除的记录");return}O.confirm("确定进行删除操作？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{D(e).then(()=>{x.success("删除成功"),m()})}).catch(d=>{console.error(d)})},k=o=>{l.dataSelections=o.map(e=>e.id)};return(o,e)=>{const d=i("el-input"),a=i("el-form-item"),u=i("el-button"),g=i("el-form"),f=i("el-table-column"),T=i("el-table"),C=i("el-pagination"),s=i("el-card"),$=U("loading");return S(),w(s,{shadow:"hover"},{default:n(()=>[t(g,{inline:!0,model:l.queryForm,onKeyup:e[5]||(e[5]=q(p=>m(),["enter"])),onSubmit:e[6]||(e[6]=E(()=>{},["prevent"]))},{default:n(()=>[t(a,null,{default:n(()=>[t(d,{modelValue:l.queryForm.columnType,"onUpdate:modelValue":e[0]||(e[0]=p=>l.queryForm.columnType=p),placeholder:"字段类型",clearable:""},null,8,["modelValue"])]),_:1}),t(a,null,{default:n(()=>[t(d,{modelValue:l.queryForm.attrType,"onUpdate:modelValue":e[1]||(e[1]=p=>l.queryForm.attrType=p),placeholder:"属性类型",clearable:""},null,8,["modelValue"])]),_:1}),t(a,null,{default:n(()=>[t(u,{onClick:e[2]||(e[2]=p=>m())},{default:n(()=>[_("查询")]),_:1}),t(u,{type:"primary",onClick:e[3]||(e[3]=p=>r())},{default:n(()=>[_("新增")]),_:1}),t(u,{type:"danger",onClick:e[4]||(e[4]=p=>b())},{default:n(()=>[_("删除")]),_:1})]),_:1})]),_:1},8,["model"]),I((S(),w(T,{data:l.data,border:!0,style:{width:"100%"},onSelectionChange:k},{default:n(()=>[t(f,{type:"selection","header-align":"center",align:"center",width:"50"}),t(f,{label:"字段类型",prop:"columnType","header-align":"center",align:"center"}),t(f,{label:"属性类型",prop:"attrType","header-align":"center",align:"center"}),t(f,{label:"属性包名",prop:"packageName","header-align":"center",align:"center"}),t(f,{label:"操作",fixed:"right","header-align":"center",align:"center",width:"150"},{default:n(p=>[t(u,{type:"primary",link:"",onClick:B=>r(p.row.id)},{default:n(()=>[_("编辑")]),_:2},1032,["onClick"]),t(u,{type:"danger",link:"",onClick:B=>b(p.row.id)},{default:n(()=>[_("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[$,l.loading]]),t(C,{"current-page":l.page.current,"page-size":l.page.pageSize,"page-sizes":[10,20,50,100,200],total:l.page.total,layout:"total,sizes,prev,pager,next,jumper",onSizeChange:c,onCurrentChange:y},null,8,["current-page","page-size","total"]),t(K,{ref_key:"addOrEditRef",ref:v,onRefreshPage:m},null,512)]),_:1})}}});export{H as default};
