import{d as $,r as w,a as S,b as u,o as U,c as h,w as o,e,f as b,m as A,E as q,q as B,s as E,t as O,v as D,x as I}from"./index-Cxp8lBjq.js";import{r as N}from"./request-C7Ncguaj.js";import{d as K}from"./download-DGuJxnsF.js";const M=f=>f.id?N.put("/gen/projectModify",f):N.post("/gen/projectModify",f),T=f=>N.delete("/gen/projectModify",{data:{ids:f}}),z=f=>N.get(`/gen/projectModify/${f}`),G=f=>N.post("/gen/projectModify/page",f),H=f=>{K.get(`/gen/projectModify/download/${f}`)},J=$({__name:"add-or-edit",emits:["refreshPage"],setup(f,{expose:d,emit:j}){const y=j,t=w(!1),V=w(),p=S({id:"",projectName:"",projectCode:"",projectCodeAbbreviate:"",projectPackage:"",projectPath:""}),x=S({projectName:[{required:!0,message:"必填项不能为空",trigger:"blur"}],projectCode:[{required:!0,message:"必填项不能为空",trigger:"blur"}],projectCodeAbbreviate:[{required:!0,message:"必填项不能为空",trigger:"blur"}],projectPackage:[{required:!0,message:"必填项不能为空",trigger:"blur"}],projectPath:[{required:!0,message:"必填项不能为空",trigger:"blur"}]}),P=r=>{t.value=!0,V.value&&V.value.resetFields(),r&&g(r)},g=r=>{z(r).then(l=>{Object.assign(p,l.data)})},a=()=>{V.value.validate(r=>{if(!r)return!1;M(p).then(()=>{t.value=!1,y("refreshPage"),q.success("操作成功")})})};return d({init:P}),(r,l)=>{const m=u("el-input"),i=u("el-form-item"),c=u("el-col"),C=u("el-row"),_=u("el-form"),k=u("el-button"),n=u("el-dialog");return U(),h(n,{modelValue:t.value,"onUpdate:modelValue":l[8]||(l[8]=s=>t.value=s),title:p.id?"修改":"新增","close-on-click-modal":!1,width:"800"},{footer:o(()=>[e(k,{onClick:l[6]||(l[6]=s=>t.value=!1)},{default:o(()=>[b("取消")]),_:1}),e(k,{type:"primary",onClick:l[7]||(l[7]=s=>a())},{default:o(()=>[b("确定")]),_:1})]),default:o(()=>[e(_,{ref_key:"dataFormRef",ref:V,model:p,rules:x,"label-width":"100",onKeyup:l[5]||(l[5]=A(s=>a(),["enter"]))},{default:o(()=>[e(i,{label:"项目名",prop:"projectName"},{default:o(()=>[e(m,{modelValue:p.projectName,"onUpdate:modelValue":l[0]||(l[0]=s=>p.projectName=s),placeholder:"项目名"},null,8,["modelValue"])]),_:1}),e(C,null,{default:o(()=>[e(c,{span:12},{default:o(()=>[e(i,{label:"项目标识",prop:"projectCode"},{default:o(()=>[e(m,{modelValue:p.projectCode,"onUpdate:modelValue":l[1]||(l[1]=s=>p.projectCode=s),placeholder:"项目标识名"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:o(()=>[e(i,{label:"标识缩写",prop:"projectCodeAbbreviate"},{default:o(()=>[e(m,{modelValue:p.projectCodeAbbreviate,"onUpdate:modelValue":l[2]||(l[2]=s=>p.projectCodeAbbreviate=s),placeholder:"标识缩写"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(C,null,{default:o(()=>[e(c,{span:12},{default:o(()=>[e(i,{label:"项目包名",prop:"projectPackage"},{default:o(()=>[e(m,{modelValue:p.projectPackage,"onUpdate:modelValue":l[3]||(l[3]=s=>p.projectPackage=s),placeholder:"项目包名"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:o(()=>[e(i,{label:"项目路径",prop:"projectPath"},{default:o(()=>[e(m,{modelValue:p.projectPath,"onUpdate:modelValue":l[4]||(l[4]=s=>p.projectPath=s),placeholder:"项目路径"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),L=$({__name:"download",setup(f,{expose:d}){const j=w(!1),y=w(),t=S({id:"",projectName:"",projectPath:"",projectCode:"",projectCodeAbbreviate:"",projectPackage:"",modifyProjectName:"",modifyProjectCode:"",modifyProjectCodeAbbreviate:"",modifyProjectPackage:"",exclusions:1,modifySuffix:""}),V=S({modifyProjectName:[{required:!0,message:"必填项不能为空",trigger:"blur"}],modifyProjectCode:[{required:!0,message:"必填项不能为空",trigger:"blur"}],modifyProjectCodeAbbreviate:[{required:!0,message:"必填项不能为空",trigger:"blur"}],modifyProjectPackage:[{required:!0,message:"必填项不能为空",trigger:"blur"}],exclusions:[{required:!0,message:"必填项不能为空",trigger:"blur"}],modifySuffix:[{required:!0,message:"必填项不能为空",trigger:"blur"}]}),p=g=>{j.value=!0,t.id="",y.value&&y.value.resetFields(),x(g)},x=g=>{z(g).then(a=>{Object.assign(t,a.data)})},P=()=>{y.value.validate(async g=>{if(!g)return!1;await M(t),H(t.id),j.value=!1})};return d({init:p}),(g,a)=>{const r=u("el-input"),l=u("el-form-item"),m=u("el-row"),i=u("el-col"),c=u("el-divider"),C=u("el-form"),_=u("el-button"),k=u("el-dialog");return U(),h(k,{modelValue:j.value,"onUpdate:modelValue":a[14]||(a[14]=n=>j.value=n),title:"源码下载","close-on-click-modal":!1},{footer:o(()=>[e(_,{onClick:a[12]||(a[12]=n=>j.value=!1)},{default:o(()=>[b("取消")]),_:1}),e(_,{type:"primary",onClick:a[13]||(a[13]=n=>P())},{default:o(()=>[b("下载")]),_:1})]),default:o(()=>[e(C,{ref_key:"dataFormRef",ref:y,model:t,rules:V,"label-width":"100",onKeyup:a[11]||(a[11]=A(n=>P(),["enter"]))},{default:o(()=>[e(m,null,{default:o(()=>[e(l,{label:"项目名",prop:"projectName",style:{width:"100%"}},{default:o(()=>[e(r,{modelValue:t.projectName,"onUpdate:modelValue":a[0]||(a[0]=n=>t.projectName=n),disabled:"",placeholder:"项目名"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,null,{default:o(()=>[e(i,{span:12},{default:o(()=>[e(l,{label:"项目标识",prop:"projectCode"},{default:o(()=>[e(r,{modelValue:t.projectCode,"onUpdate:modelValue":a[1]||(a[1]=n=>t.projectCode=n),disabled:"",placeholder:"项目标识"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:o(()=>[e(l,{label:"标识缩写",prop:"projectCode"},{default:o(()=>[e(r,{modelValue:t.projectCodeAbbreviate,"onUpdate:modelValue":a[2]||(a[2]=n=>t.projectCodeAbbreviate=n),disabled:"",placeholder:"标识缩写"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:o(()=>[e(l,{label:"项目包名",prop:"projectPackage"},{default:o(()=>[e(r,{modelValue:t.projectPackage,"onUpdate:modelValue":a[3]||(a[3]=n=>t.projectPackage=n),disabled:"",placeholder:"项目包名"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:o(()=>[e(l,{label:"项目路径",prop:"projectPath"},{default:o(()=>[e(r,{modelValue:t.projectPath,"onUpdate:modelValue":a[4]||(a[4]=n=>t.projectPath=n),disabled:"",placeholder:"项目路径"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(c,null,{default:o(()=>[b("变更后的信息")]),_:1}),e(m,null,{default:o(()=>[e(i,{span:12},{default:o(()=>[e(l,{label:"项目名",prop:"modifyProjectName"},{default:o(()=>[e(r,{modelValue:t.modifyProjectName,"onUpdate:modelValue":a[5]||(a[5]=n=>t.modifyProjectName=n),placeholder:"项目名"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:o(()=>[e(l,{label:"项目标识",prop:"modifyProjectCode"},{default:o(()=>[e(r,{modelValue:t.modifyProjectCode,"onUpdate:modelValue":a[6]||(a[6]=n=>t.modifyProjectCode=n),placeholder:"项目标识"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:o(()=>[e(l,{label:"标识缩写",prop:"modifyProjectCodeAbbreviate"},{default:o(()=>[e(r,{modelValue:t.modifyProjectCodeAbbreviate,"onUpdate:modelValue":a[7]||(a[7]=n=>t.modifyProjectCodeAbbreviate=n),placeholder:"标识缩写"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:o(()=>[e(l,{label:"项目包名",prop:"modifyProjectPackage"},{default:o(()=>[e(r,{modelValue:t.modifyProjectPackage,"onUpdate:modelValue":a[8]||(a[8]=n=>t.modifyProjectPackage=n),placeholder:"项目包名"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:o(()=>[e(l,{label:"排除文件",prop:"exclusions"},{default:o(()=>[e(r,{modelValue:t.exclusions,"onUpdate:modelValue":a[9]||(a[9]=n=>t.exclusions=n),placeholder:"排除文件"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:o(()=>[e(l,{label:"变更文件",prop:"modifySuffix"},{default:o(()=>[e(r,{modelValue:t.modifySuffix,"onUpdate:modelValue":a[10]||(a[10]=n=>t.modifySuffix=n),placeholder:"变更文件"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}}),Y=$({__name:"index",setup(f){const d=S({queryForm:{projectName:""},page:{current:1,pageSize:10,total:0,orderItems:[{column:"createTime",asc:!1}]},data:[],dataSelections:[],loading:!1}),j=w(),y=w();B(()=>{t()});const t=(r=1,l)=>{d.page.current=r,l!==void 0&&(d.page.pageSize=l),d.loading=!0;const m={current:d.page.current,pageSize:d.page.pageSize,orderItems:d.page.orderItems,...d.queryForm};G(m).then(i=>{const{list:c,total:C}=i.data;d.data=c,d.page.total=C}),d.loading=!1},V=r=>{t(1,r)},p=r=>{t(r)},x=r=>{y.value.init(r)},P=r=>{j.value.init(r)},g=r=>{let l=[];if(r)l=[r];else if(l=d.dataSelections?d.dataSelections:[],l.length===0){q.warning("请选择删除的记录");return}I.confirm("确定进行删除操作？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{T(l).then(()=>{q.success("删除成功"),t()})}).catch(m=>{console.error(m)})},a=r=>{d.dataSelections=r.map(l=>l.id)};return(r,l)=>{const m=u("el-input"),i=u("el-form-item"),c=u("el-button"),C=u("el-form"),_=u("el-table-column"),k=u("el-table"),n=u("el-pagination"),s=u("el-card"),R=E("loading");return U(),h(s,{shadow:"hover"},{default:o(()=>[e(C,{inline:!0,model:d.queryForm,onKeyup:l[4]||(l[4]=A(v=>t(),["enter"])),onSubmit:l[5]||(l[5]=O(()=>{},["prevent"]))},{default:o(()=>[e(i,null,{default:o(()=>[e(m,{modelValue:d.queryForm.projectName,"onUpdate:modelValue":l[0]||(l[0]=v=>d.queryForm.projectName=v),placeholder:"项目名",clearable:""},null,8,["modelValue"])]),_:1}),e(i,null,{default:o(()=>[e(c,{onClick:l[1]||(l[1]=v=>t())},{default:o(()=>[b("查询")]),_:1}),e(c,{type:"primary",onClick:l[2]||(l[2]=v=>P())},{default:o(()=>[b("新增")]),_:1}),e(c,{type:"danger",onClick:l[3]||(l[3]=v=>g())},{default:o(()=>[b("删除")]),_:1})]),_:1})]),_:1},8,["model"]),D((U(),h(k,{data:d.data,border:!0,style:{width:"100%"},onSelectionChange:a},{default:o(()=>[e(_,{type:"selection","header-align":"center",align:"center",width:"50"}),e(_,{label:"项目名",prop:"projectName","header-align":"center",align:"center"}),e(_,{label:"项目标识",prop:"projectCode","header-align":"center",align:"center"}),e(_,{label:"项目包名",prop:"projectPackage","show-overflow-tooltip":"","header-align":"center",align:"center"}),e(_,{label:"项目路径",prop:"projectPath","show-overflow-tooltip":"","header-align":"center",align:"center"}),e(_,{label:"操作",fixed:"right","header-align":"center",align:"center",width:"180"},{default:o(v=>[e(c,{type:"success",link:"",onClick:F=>x(v.row.id)},{default:o(()=>[b("源码下载")]),_:2},1032,["onClick"]),e(c,{type:"primary",link:"",onClick:F=>P(v.row.id)},{default:o(()=>[b("编辑")]),_:2},1032,["onClick"]),e(c,{type:"danger",link:"",onClick:F=>g(v.row.id)},{default:o(()=>[b("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[R,d.loading]]),e(n,{"current-page":d.page.current,"page-size":d.page.pageSize,"page-sizes":[10,20,50,100,200],total:d.page.total,layout:"total,sizes,prev,pager,next,jumper",onSizeChange:V,onCurrentChange:p},null,8,["current-page","page-size","total"]),e(J,{ref_key:"addOrEditRef",ref:j,onRefreshPage:t},null,512),e(L,{ref_key:"downloadRef",ref:y},null,512)]),_:1})}}});export{Y as default};
