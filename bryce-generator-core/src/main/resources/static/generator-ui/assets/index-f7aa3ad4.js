import{d as $,r as P,a as w,b as i,o as S,c as N,w as o,e,f as j,m as q,E as U,q as E,s as O,t as D,v as I,x as K}from"./index-7b584818.js";import{r as x}from"./request-e217e25d.js";import{d as T}from"./download-c5037e86.js";const M=m=>m.id?x.put("/gen/projectModify",m):x.post("/gen/projectModify",m),A=m=>x.delete("/gen/projectModify",{data:{ids:m}}),z=m=>x.get(`/gen/projectModify/${m}`),G=m=>x.post("/gen/projectModify/page",m),H=m=>{T.get(`/gen/projectModify/download/${m}`)},J=$({__name:"add-or-edit",emits:["refreshPage"],setup(m,{expose:r,emit:y}){const c=P(!1),n=P(),s=w({id:"",projectName:"",projectCode:"",projectPackage:"",projectPath:""}),C=w({projectName:[{required:!0,message:"必填项不能为空",trigger:"blur"}],projectCode:[{required:!0,message:"必填项不能为空",trigger:"blur"}],projectPackage:[{required:!0,message:"必填项不能为空",trigger:"blur"}],projectPath:[{required:!0,message:"必填项不能为空",trigger:"blur"}]}),k=t=>{c.value=!0,n.value&&n.value.resetFields(),t&&v(t)},v=t=>{z(t).then(l=>{Object.assign(s,l.data)})},g=()=>{n.value.validate(t=>{if(!t)return!1;M(s).then(()=>{U.success({message:"操作成功",duration:500,onClose:()=>{c.value=!1,y("refreshPage")}})})})};return r({init:k}),(t,l)=>{const a=i("el-input"),p=i("el-form-item"),_=i("el-form"),f=i("el-button"),V=i("el-dialog");return S(),N(V,{modelValue:c.value,"onUpdate:modelValue":l[7]||(l[7]=u=>c.value=u),title:s.id?"修改":"新增","close-on-click-modal":!1},{footer:o(()=>[e(f,{onClick:l[5]||(l[5]=u=>c.value=!1)},{default:o(()=>[j("取消")]),_:1}),e(f,{type:"primary",onClick:l[6]||(l[6]=u=>g())},{default:o(()=>[j("确定")]),_:1})]),default:o(()=>[e(_,{ref_key:"dataFormRef",ref:n,model:s,rules:C,"label-width":"100px",onKeyup:l[4]||(l[4]=q(u=>g(),["enter"]))},{default:o(()=>[e(p,{label:"项目名",prop:"projectName"},{default:o(()=>[e(a,{modelValue:s.projectName,"onUpdate:modelValue":l[0]||(l[0]=u=>s.projectName=u),placeholder:"项目名"},null,8,["modelValue"])]),_:1}),e(p,{label:"项目标识",prop:"projectCode"},{default:o(()=>[e(a,{modelValue:s.projectCode,"onUpdate:modelValue":l[1]||(l[1]=u=>s.projectCode=u),placeholder:"项目标识"},null,8,["modelValue"])]),_:1}),e(p,{label:"项目包名",prop:"projectPackage"},{default:o(()=>[e(a,{modelValue:s.projectPackage,"onUpdate:modelValue":l[2]||(l[2]=u=>s.projectPackage=u),placeholder:"项目包名"},null,8,["modelValue"])]),_:1}),e(p,{label:"项目路径",prop:"projectPath"},{default:o(()=>[e(a,{modelValue:s.projectPath,"onUpdate:modelValue":l[3]||(l[3]=u=>s.projectPath=u),placeholder:"项目路径"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),L=$({__name:"download",setup(m,{expose:r}){const y=P(!1),c=P(),n=w({id:"",projectName:"",projectPath:"",projectCode:"",projectPackage:"",modifyProjectName:"",modifyProjectCode:"",modifyProjectPackage:"",exclusions:1,modifySuffix:""}),s=w({modifyProjectName:[{required:!0,message:"必填项不能为空",trigger:"blur"}],modifyProjectCode:[{required:!0,message:"必填项不能为空",trigger:"blur"}],modifyProjectPackage:[{required:!0,message:"必填项不能为空",trigger:"blur"}],exclusions:[{required:!0,message:"必填项不能为空",trigger:"blur"}],modifySuffix:[{required:!0,message:"必填项不能为空",trigger:"blur"}]}),C=g=>{y.value=!0,n.id="",c.value&&c.value.resetFields(),k(g)},k=g=>{z(g).then(t=>{Object.assign(n,t.data)})},v=()=>{c.value.validate(async g=>{if(!g)return!1;await M(n),H(n.id),y.value=!1})};return r({init:C}),(g,t)=>{const l=i("el-input"),a=i("el-form-item"),p=i("el-col"),_=i("el-row"),f=i("el-divider"),V=i("el-form"),u=i("el-button"),h=i("el-dialog");return S(),N(h,{modelValue:y.value,"onUpdate:modelValue":t[12]||(t[12]=d=>y.value=d),title:"源码下载","close-on-click-modal":!1},{footer:o(()=>[e(u,{onClick:t[10]||(t[10]=d=>y.value=!1)},{default:o(()=>[j("取消")]),_:1}),e(u,{type:"primary",onClick:t[11]||(t[11]=d=>v())},{default:o(()=>[j("下载")]),_:1})]),default:o(()=>[e(V,{ref_key:"dataFormRef",ref:c,model:n,rules:s,"label-width":"100px",onKeyup:t[9]||(t[9]=q(d=>v(),["enter"]))},{default:o(()=>[e(_,null,{default:o(()=>[e(p,{span:12},{default:o(()=>[e(a,{label:"项目名",prop:"projectName"},{default:o(()=>[e(l,{modelValue:n.projectName,"onUpdate:modelValue":t[0]||(t[0]=d=>n.projectName=d),disabled:"",placeholder:"项目名"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:o(()=>[e(a,{label:"项目路径",prop:"projectPath"},{default:o(()=>[e(l,{modelValue:n.projectPath,"onUpdate:modelValue":t[1]||(t[1]=d=>n.projectPath=d),disabled:"",placeholder:"项目路径"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,null,{default:o(()=>[e(p,{span:12},{default:o(()=>[e(a,{label:"项目标识",prop:"projectCode"},{default:o(()=>[e(l,{modelValue:n.projectCode,"onUpdate:modelValue":t[2]||(t[2]=d=>n.projectCode=d),disabled:"",placeholder:"项目标识"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:o(()=>[e(a,{label:"项目包名",prop:"projectPackage"},{default:o(()=>[e(l,{modelValue:n.projectPackage,"onUpdate:modelValue":t[3]||(t[3]=d=>n.projectPackage=d),disabled:"",placeholder:"项目包名"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,null,{default:o(()=>[j("变更后的信息")]),_:1}),e(a,{label:"项目名",prop:"modifyProjectName"},{default:o(()=>[e(l,{modelValue:n.modifyProjectName,"onUpdate:modelValue":t[4]||(t[4]=d=>n.modifyProjectName=d),placeholder:"项目名"},null,8,["modelValue"])]),_:1}),e(_,null,{default:o(()=>[e(p,{span:12},{default:o(()=>[e(a,{label:"项目标识",prop:"modifyProjectCode"},{default:o(()=>[e(l,{modelValue:n.modifyProjectCode,"onUpdate:modelValue":t[5]||(t[5]=d=>n.modifyProjectCode=d),placeholder:"项目标识"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:o(()=>[e(a,{label:"项目包名",prop:"modifyProjectPackage"},{default:o(()=>[e(l,{modelValue:n.modifyProjectPackage,"onUpdate:modelValue":t[6]||(t[6]=d=>n.modifyProjectPackage=d),placeholder:"项目包名"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,null,{default:o(()=>[e(p,{span:12},{default:o(()=>[e(a,{label:"排除文件",prop:"exclusions"},{default:o(()=>[e(l,{modelValue:n.exclusions,"onUpdate:modelValue":t[7]||(t[7]=d=>n.exclusions=d),placeholder:"排除文件"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:o(()=>[e(a,{label:"变更文件",prop:"modifySuffix"},{default:o(()=>[e(l,{modelValue:n.modifySuffix,"onUpdate:modelValue":t[8]||(t[8]=d=>n.modifySuffix=d),placeholder:"变更文件"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}}),Y=$({__name:"index",setup(m){const r=w({queryForm:{projectName:""},page:{current:1,pageSize:10,total:0,orderItems:[{column:"createTime",asc:!1}]},data:[],dataSelections:[],loading:!1}),y=P(),c=P();E(()=>{n()});const n=(l=1,a)=>{r.page.current=l,a!==void 0&&(r.page.pageSize=a),r.loading=!0;const p={current:r.page.current,pageSize:r.page.pageSize,orderItems:r.page.orderItems,...r.queryForm};G(p).then(_=>{const{list:f,total:V}=_.data;r.data=f,r.page.total=V}),r.loading=!1},s=l=>{n(1,l)},C=l=>{n(l)},k=l=>{c.value.init(l)},v=l=>{y.value.init(l)},g=l=>{let a=[];if(l)a=[l];else if(a=r.dataSelections?r.dataSelections:[],a.length===0){U.warning("请选择删除的记录");return}K.confirm("确定进行删除操作？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{A(a).then(()=>{U.success("删除成功"),n()})}).catch(p=>{console.error(p)})},t=l=>{r.dataSelections=l.map(a=>a.id)};return(l,a)=>{const p=i("el-input"),_=i("el-form-item"),f=i("el-button"),V=i("el-form"),u=i("el-table-column"),h=i("el-table"),d=i("el-pagination"),R=i("el-card"),B=O("loading");return S(),N(R,{shadow:"hover"},{default:o(()=>[e(V,{inline:!0,model:r.queryForm,onKeyup:a[4]||(a[4]=q(b=>n(),["enter"])),onSubmit:a[5]||(a[5]=D(()=>{},["prevent"]))},{default:o(()=>[e(_,null,{default:o(()=>[e(p,{modelValue:r.queryForm.projectName,"onUpdate:modelValue":a[0]||(a[0]=b=>r.queryForm.projectName=b),placeholder:"项目名"},null,8,["modelValue"])]),_:1}),e(_,null,{default:o(()=>[e(f,{onClick:a[1]||(a[1]=b=>n())},{default:o(()=>[j("查询")]),_:1}),e(f,{type:"primary",onClick:a[2]||(a[2]=b=>v())},{default:o(()=>[j("新增")]),_:1}),e(f,{type:"danger",onClick:a[3]||(a[3]=b=>g())},{default:o(()=>[j("删除")]),_:1})]),_:1})]),_:1},8,["model"]),I((S(),N(h,{data:r.data,border:!0,style:{width:"100%"},onSelectionChange:t},{default:o(()=>[e(u,{type:"selection","header-align":"center",align:"center",width:"50"}),e(u,{label:"项目名",prop:"projectName","header-align":"center",align:"center"}),e(u,{label:"项目标识",prop:"projectCode","header-align":"center",align:"center"}),e(u,{label:"项目包名",prop:"projectPackage","show-overflow-tooltip":"","header-align":"center",align:"center"}),e(u,{label:"项目路径",prop:"projectPath","show-overflow-tooltip":"","header-align":"center",align:"center"}),e(u,{label:"操作",fixed:"right","header-align":"center",align:"center",width:"180"},{default:o(b=>[e(f,{type:"success",link:"",onClick:F=>k(b.row.id)},{default:o(()=>[j("源码下载")]),_:2},1032,["onClick"]),e(f,{type:"primary",link:"",onClick:F=>v(b.row.id)},{default:o(()=>[j("编辑")]),_:2},1032,["onClick"]),e(f,{type:"danger",link:"",onClick:F=>g(b.row.id)},{default:o(()=>[j("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[B,r.loading]]),e(d,{"current-page":r.page.current,"page-size":r.page.pageSize,"page-sizes":[10,20,50,100,200],total:r.page.total,layout:"total,sizes,prev,pager,next,jumper",onSizeChange:s,onCurrentChange:C},null,8,["current-page","page-size","total"]),e(J,{ref_key:"addOrEditRef",ref:y,onRefreshPage:n},null,512),e(L,{ref_key:"downloadRef",ref:c},null,512)]),_:1})}}});export{Y as default};
