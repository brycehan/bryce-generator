import{d as F,r as k,a as N,b as i,c as $,o as U,w as o,e,m as M,i as m,E as A,y as S,q as E,s as O,t as I,v as K,x as T}from"./index-CuHfYZIc.js";import{r as q}from"./request-ChiGirky.js";import{d as G}from"./download-DhycBs8O.js";const R=f=>f.id?q.put("/gen/projectModify",f):q.post("/gen/projectModify",f),H=f=>q.delete("/gen/projectModify",{data:{ids:f}}),B=f=>q.get(`/gen/projectModify/${f}`),J=f=>q.post("/gen/projectModify/page",f),L=f=>{G.get(`/gen/projectModify/download/${f}`)},Q=F({__name:"add-or-edit",emits:["refreshPage"],setup(f,{expose:d,emit:b}){const y=b,l=k(!1),C=k(),s=N({id:"",projectName:"",projectCode:"",projectCodeAbbreviate:"",projectPackage:"",projectPath:""}),w=N({projectName:[{required:!0,message:"必填项不能为空",trigger:"blur"}],projectCode:[{required:!0,message:"必填项不能为空",trigger:"blur"}],projectCodeAbbreviate:[{required:!0,message:"必填项不能为空",trigger:"blur"}],projectPackage:[{required:!0,message:"必填项不能为空",trigger:"blur"}],projectPath:[{required:!0,message:"必填项不能为空",trigger:"blur"}]}),P=n=>{l.value=!0,C.value&&C.value.resetFields(),n&&_(n)},_=n=>{B(n).then(t=>{Object.assign(s,t.data)})},a=()=>{C.value.validate(n=>{if(!n)return!1;R(s).then(()=>{l.value=!1,y("refreshPage"),A.success("操作成功")})})};return d({init:P}),(n,t)=>{const p=i("el-input"),c=i("el-form-item"),u=i("el-col"),g=i("el-row"),j=i("el-form"),V=i("el-button"),x=i("el-dialog");return U(),$(x,{modelValue:l.value,"onUpdate:modelValue":t[8]||(t[8]=r=>l.value=r),title:s.id?"修改":"新增","close-on-click-modal":!1,width:"800"},{footer:o(()=>[e(V,{onClick:t[6]||(t[6]=r=>l.value=!1)},{default:o(()=>t[9]||(t[9]=[m("取消")])),_:1}),e(V,{type:"primary",onClick:t[7]||(t[7]=r=>a())},{default:o(()=>t[10]||(t[10]=[m("确定")])),_:1})]),default:o(()=>[e(j,{ref_key:"dataFormRef",ref:C,model:s,rules:w,"label-width":"100",onKeyup:t[5]||(t[5]=M(r=>a(),["enter"]))},{default:o(()=>[e(c,{label:"项目名",prop:"projectName"},{default:o(()=>[e(p,{modelValue:s.projectName,"onUpdate:modelValue":t[0]||(t[0]=r=>s.projectName=r),placeholder:"项目名"},null,8,["modelValue"])]),_:1}),e(g,null,{default:o(()=>[e(u,{span:12},{default:o(()=>[e(c,{label:"项目标识",prop:"projectCode"},{default:o(()=>[e(p,{modelValue:s.projectCode,"onUpdate:modelValue":t[1]||(t[1]=r=>s.projectCode=r),placeholder:"项目标识名"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:o(()=>[e(c,{label:"标识缩写",prop:"projectCodeAbbreviate"},{default:o(()=>[e(p,{modelValue:s.projectCodeAbbreviate,"onUpdate:modelValue":t[2]||(t[2]=r=>s.projectCodeAbbreviate=r),placeholder:"标识缩写"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(g,null,{default:o(()=>[e(u,{span:12},{default:o(()=>[e(c,{label:"项目包名",prop:"projectPackage"},{default:o(()=>[e(p,{modelValue:s.projectPackage,"onUpdate:modelValue":t[3]||(t[3]=r=>s.projectPackage=r),placeholder:"项目包名"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:o(()=>[e(c,{label:"项目路径",prop:"projectPath"},{default:o(()=>[e(p,{modelValue:s.projectPath,"onUpdate:modelValue":t[4]||(t[4]=r=>s.projectPath=r),placeholder:"项目路径"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),W=F({__name:"download",setup(f,{expose:d}){const b=k(!1),y=k(),l=N({id:"",projectName:"",projectPath:"",projectCode:"",projectCodeAbbreviate:"",projectPackage:"",modifyProjectName:"",modifyProjectCode:"",modifyProjectCodeAbbreviate:"",modifyProjectPackage:"",exclusions:1,modifySuffix:""}),C=N({modifyProjectName:[{required:!0,message:"必填项不能为空",trigger:"blur"}],modifyProjectCode:[{required:!0,message:"必填项不能为空",trigger:"blur"}],modifyProjectCodeAbbreviate:[{required:!0,message:"必填项不能为空",trigger:"blur"}],modifyProjectPackage:[{required:!0,message:"必填项不能为空",trigger:"blur"}],exclusions:[{required:!0,message:"必填项不能为空",trigger:"blur"}],modifySuffix:[{required:!0,message:"必填项不能为空",trigger:"blur"}]}),s=_=>{b.value=!0,l.id="",y.value&&y.value.resetFields(),w(_)},w=_=>{B(_).then(a=>{Object.assign(l,a.data)})},P=()=>{y.value.validate(async _=>{if(!_)return!1;await R(l),L(l.id),b.value=!1})};return d({init:s}),(_,a)=>{const n=i("el-divider"),t=i("el-text"),p=i("el-form-item"),c=i("el-row"),u=i("el-col"),g=i("el-input"),j=i("el-form"),V=i("el-button"),x=i("el-dialog");return U(),$(x,{modelValue:b.value,"onUpdate:modelValue":a[9]||(a[9]=r=>b.value=r),title:"源码下载","close-on-click-modal":!1},{footer:o(()=>[e(V,{onClick:a[7]||(a[7]=r=>b.value=!1)},{default:o(()=>a[12]||(a[12]=[m("取消")])),_:1}),e(V,{type:"primary",onClick:a[8]||(a[8]=r=>P())},{default:o(()=>a[13]||(a[13]=[m("下载")])),_:1})]),default:o(()=>[e(j,{ref_key:"dataFormRef",ref:y,model:l,rules:C,"label-width":"100",onKeyup:a[6]||(a[6]=M(r=>P(),["enter"]))},{default:o(()=>[e(n,{"content-position":"left"},{default:o(()=>a[10]||(a[10]=[m("项目信息")])),_:1}),e(c,null,{default:o(()=>[e(p,{label:"项目名",prop:"projectName",style:{width:"100%"}},{default:o(()=>[e(t,null,{default:o(()=>[m(S(l.projectName),1)]),_:1})]),_:1})]),_:1}),e(c,null,{default:o(()=>[e(u,{span:12},{default:o(()=>[e(p,{label:"项目标识",prop:"projectCode"},{default:o(()=>[e(t,null,{default:o(()=>[m(S(l.projectCode),1)]),_:1})]),_:1})]),_:1}),e(u,{span:12},{default:o(()=>[e(p,{label:"标识缩写",prop:"projectCode"},{default:o(()=>[e(t,null,{default:o(()=>[m(S(l.projectCodeAbbreviate),1)]),_:1})]),_:1})]),_:1}),e(u,{span:12},{default:o(()=>[e(p,{label:"项目包名",prop:"projectPackage"},{default:o(()=>[e(t,null,{default:o(()=>[m(S(l.projectPackage),1)]),_:1})]),_:1})]),_:1}),e(u,{span:12},{default:o(()=>[e(p,{label:"项目路径",prop:"projectPath"},{default:o(()=>[e(t,null,{default:o(()=>[m(S(l.projectPath),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(n,{"content-position":"left"},{default:o(()=>a[11]||(a[11]=[m("修改后的信息")])),_:1}),e(c,null,{default:o(()=>[e(u,{span:12},{default:o(()=>[e(p,{label:"项目名",prop:"modifyProjectName"},{default:o(()=>[e(g,{modelValue:l.modifyProjectName,"onUpdate:modelValue":a[0]||(a[0]=r=>l.modifyProjectName=r),placeholder:"项目名"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:o(()=>[e(p,{label:"项目标识",prop:"modifyProjectCode"},{default:o(()=>[e(g,{modelValue:l.modifyProjectCode,"onUpdate:modelValue":a[1]||(a[1]=r=>l.modifyProjectCode=r),placeholder:"项目标识"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:o(()=>[e(p,{label:"标识缩写",prop:"modifyProjectCodeAbbreviate"},{default:o(()=>[e(g,{modelValue:l.modifyProjectCodeAbbreviate,"onUpdate:modelValue":a[2]||(a[2]=r=>l.modifyProjectCodeAbbreviate=r),placeholder:"标识缩写"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:o(()=>[e(p,{label:"项目包名",prop:"modifyProjectPackage"},{default:o(()=>[e(g,{modelValue:l.modifyProjectPackage,"onUpdate:modelValue":a[3]||(a[3]=r=>l.modifyProjectPackage=r),placeholder:"项目包名"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:o(()=>[e(p,{label:"排除文件",prop:"exclusions"},{default:o(()=>[e(g,{modelValue:l.exclusions,"onUpdate:modelValue":a[4]||(a[4]=r=>l.exclusions=r),placeholder:"排除文件"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:o(()=>[e(p,{label:"变更文件",prop:"modifySuffix"},{default:o(()=>[e(g,{modelValue:l.modifySuffix,"onUpdate:modelValue":a[5]||(a[5]=r=>l.modifySuffix=r),placeholder:"变更文件"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}}),h=F({__name:"index",setup(f){const d=N({queryForm:{projectName:""},page:{current:1,pageSize:10,total:0,orderItems:[{column:"createTime",asc:!1}]},data:[],dataSelections:[],loading:!1}),b=k(),y=k();E(()=>{l()});const l=(n=1,t)=>{d.page.current=n,t!==void 0&&(d.page.pageSize=t),d.loading=!0;const p={current:d.page.current,pageSize:d.page.pageSize,orderItems:d.page.orderItems,...d.queryForm};J(p).then(c=>{const{list:u,total:g}=c.data;d.data=u,d.page.total=g}),d.loading=!1},C=n=>{l(1,n)},s=n=>{l(n)},w=n=>{y.value.init(n)},P=n=>{b.value.init(n)},_=n=>{let t=[];if(n)t=[n];else if(t=d.dataSelections?d.dataSelections:[],t.length===0){A.warning("请选择删除的记录");return}T.confirm("确定进行删除操作？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{H(t).then(()=>{A.success("删除成功"),l()})}).catch(p=>{console.error(p)})},a=n=>{d.dataSelections=n.map(t=>t.id)};return(n,t)=>{const p=i("el-input"),c=i("el-form-item"),u=i("el-button"),g=i("el-form"),j=i("el-table-column"),V=i("el-table"),x=i("el-pagination"),r=i("el-card"),D=O("loading");return U(),$(r,{shadow:"hover"},{default:o(()=>[e(g,{inline:!0,model:d.queryForm,onKeyup:t[4]||(t[4]=M(v=>l(),["enter"])),onSubmit:t[5]||(t[5]=K(()=>{},["prevent"]))},{default:o(()=>[e(c,null,{default:o(()=>[e(p,{modelValue:d.queryForm.projectName,"onUpdate:modelValue":t[0]||(t[0]=v=>d.queryForm.projectName=v),placeholder:"项目名",clearable:""},null,8,["modelValue"])]),_:1}),e(c,null,{default:o(()=>[e(u,{onClick:t[1]||(t[1]=v=>l())},{default:o(()=>t[6]||(t[6]=[m("查询")])),_:1}),e(u,{type:"primary",onClick:t[2]||(t[2]=v=>P())},{default:o(()=>t[7]||(t[7]=[m("新增")])),_:1}),e(u,{type:"danger",onClick:t[3]||(t[3]=v=>_())},{default:o(()=>t[8]||(t[8]=[m("删除")])),_:1})]),_:1})]),_:1},8,["model"]),I((U(),$(V,{data:d.data,border:!0,style:{width:"100%"},onSelectionChange:a},{default:o(()=>[e(j,{type:"selection","header-align":"center",align:"center",width:"50"}),e(j,{label:"项目名",prop:"projectName","header-align":"center",align:"center"}),e(j,{label:"项目标识",prop:"projectCode","header-align":"center",align:"center"}),e(j,{label:"项目包名",prop:"projectPackage","show-overflow-tooltip":"","header-align":"center",align:"center"}),e(j,{label:"项目路径",prop:"projectPath","show-overflow-tooltip":"","header-align":"center",align:"center"}),e(j,{label:"操作",fixed:"right","header-align":"center",align:"center",width:"180"},{default:o(v=>[e(u,{type:"success",link:"",onClick:z=>w(v.row.id)},{default:o(()=>t[9]||(t[9]=[m("源码下载")])),_:2},1032,["onClick"]),e(u,{type:"primary",link:"",onClick:z=>P(v.row.id)},{default:o(()=>t[10]||(t[10]=[m("编辑")])),_:2},1032,["onClick"]),e(u,{type:"danger",link:"",onClick:z=>_(v.row.id)},{default:o(()=>t[11]||(t[11]=[m("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[D,d.loading]]),e(x,{"current-page":d.page.current,"page-size":d.page.pageSize,"page-sizes":[10,20,50,100,200],total:d.page.total,layout:"total,sizes,prev,pager,next,jumper",onSizeChange:C,onCurrentChange:s},null,8,["current-page","page-size","total"]),e(Q,{ref_key:"addOrEditRef",ref:b,onRefreshPage:l},null,512),e(W,{ref_key:"downloadRef",ref:y},null,512)]),_:1})}}});export{h as default};
