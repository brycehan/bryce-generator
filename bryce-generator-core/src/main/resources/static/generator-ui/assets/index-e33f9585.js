import{d as x,r as C,a as V,b as i,o as h,c as S,w as n,e as t,f as g,m as F,E as w,q as N,s as U,t as E,v as I,x as O}from"./index-7b584818.js";import{g as R,s as M,p as P,d as D}from"./fieldType-6511392f.js";import"./request-e217e25d.js";const K=x({__name:"add-or-edit",emits:["refreshPage"],setup(q,{expose:a,emit:y}){const r=C(!1),f=C(),d=V({id:"",columnType:"",attrType:"",packageName:"",createTime:""}),v=V({columnType:[{required:!0,message:"必填项不能为空",trigger:"blur"}],attrType:[{required:!0,message:"必填项不能为空",trigger:"blur"}]}),b=e=>{r.value=!0,d.id="",f.value&&f.value.resetFields(),e&&T(e)},T=e=>{R(e).then(l=>{Object.assign(d,l.data)})},o=()=>{f.value.validate(e=>{if(!e)return!1;M(d).then(()=>{w.success({message:"操作成功",duration:500,onClose:()=>{r.value=!1,y("refreshPage")}})})})};return a({init:b}),(e,l)=>{const m=i("el-input"),u=i("el-form-item"),_=i("el-form"),c=i("el-button"),k=i("el-dialog");return h(),S(k,{modelValue:r.value,"onUpdate:modelValue":l[6]||(l[6]=s=>r.value=s),title:d.id?"修改":"新增","close-on-click-modal":!1},{footer:n(()=>[t(c,{onClick:l[4]||(l[4]=s=>r.value=!1)},{default:n(()=>[g("取消")]),_:1}),t(c,{type:"primary",onClick:l[5]||(l[5]=s=>o())},{default:n(()=>[g("确定")]),_:1})]),default:n(()=>[t(_,{ref_key:"dataFormRef",ref:f,model:d,rules:v,"label-width":"120px",onKeyup:l[3]||(l[3]=F(s=>o(),["enter"]))},{default:n(()=>[t(u,{label:"字段类型",prop:"columnType"},{default:n(()=>[t(m,{modelValue:d.columnType,"onUpdate:modelValue":l[0]||(l[0]=s=>d.columnType=s),placeholder:"字段类型"},null,8,["modelValue"])]),_:1}),t(u,{label:"属性类型",prop:"attrType"},{default:n(()=>[t(m,{modelValue:d.attrType,"onUpdate:modelValue":l[1]||(l[1]=s=>d.attrType=s),placeholder:"属性类型"},null,8,["modelValue"])]),_:1}),t(u,{label:"属性包名",prop:"packageName"},{default:n(()=>[t(m,{modelValue:d.packageName,"onUpdate:modelValue":l[2]||(l[2]=s=>d.packageName=s),placeholder:"属性包名"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),H=x({__name:"index",setup(q){const a=V({queryForm:{columnType:"",attrType:"",packageName:""},page:{current:1,pageSize:10,total:0,orderItems:[{column:"createTime",asc:!1}]},data:[],dataSelections:[],loading:!1}),y=C();N(()=>{r()});const r=(o=1,e)=>{a.page.current=o,e!==void 0&&(a.page.pageSize=e),a.loading=!0;const l={current:a.page.current,pageSize:a.page.pageSize,orderItems:a.page.orderItems,...a.queryForm};P(l).then(m=>{const{list:u,total:_}=m.data;a.data=u,a.page.total=_}),a.loading=!1},f=o=>{r(1,o)},d=o=>{r(o)},v=o=>{y.value.init(o)},b=o=>{let e=[];if(o)e=[o];else if(e=a.dataSelections?a.dataSelections:[],e.length===0){w.warning("请选择删除的记录");return}O.confirm("确定进行删除操作？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{D(e).then(()=>{w.success("删除成功"),r()})}).catch(l=>{console.error(l)})},T=o=>{a.dataSelections=o.map(e=>e.id)};return(o,e)=>{const l=i("el-input"),m=i("el-form-item"),u=i("el-button"),_=i("el-form"),c=i("el-table-column"),k=i("el-table"),s=i("el-pagination"),z=i("el-card"),$=U("loading");return h(),S(z,{shadow:"hover"},{default:n(()=>[t(_,{inline:!0,model:a.queryForm,onKeyup:e[5]||(e[5]=F(p=>r(),["enter"])),onSubmit:e[6]||(e[6]=E(()=>{},["prevent"]))},{default:n(()=>[t(m,null,{default:n(()=>[t(l,{modelValue:a.queryForm.columnType,"onUpdate:modelValue":e[0]||(e[0]=p=>a.queryForm.columnType=p),placeholder:"字段类型"},null,8,["modelValue"])]),_:1}),t(m,null,{default:n(()=>[t(l,{modelValue:a.queryForm.attrType,"onUpdate:modelValue":e[1]||(e[1]=p=>a.queryForm.attrType=p),placeholder:"属性类型"},null,8,["modelValue"])]),_:1}),t(m,null,{default:n(()=>[t(u,{onClick:e[2]||(e[2]=p=>r())},{default:n(()=>[g("查询")]),_:1}),t(u,{type:"primary",onClick:e[3]||(e[3]=p=>v())},{default:n(()=>[g("新增")]),_:1}),t(u,{type:"danger",onClick:e[4]||(e[4]=p=>b())},{default:n(()=>[g("删除")]),_:1})]),_:1})]),_:1},8,["model"]),I((h(),S(k,{data:a.data,border:!0,style:{width:"100%"},onSelectionChange:T},{default:n(()=>[t(c,{type:"selection","header-align":"center",align:"center",width:"50"}),t(c,{label:"字段类型",prop:"columnType","header-align":"center",align:"center"}),t(c,{label:"属性类型",prop:"attrType","header-align":"center",align:"center"}),t(c,{label:"属性包名",prop:"packageName","header-align":"center",align:"center"}),t(c,{label:"操作",fixed:"right","header-align":"center",align:"center",width:"150"},{default:n(p=>[t(u,{type:"primary",link:"",onClick:B=>v(p.row.id)},{default:n(()=>[g("编辑")]),_:2},1032,["onClick"]),t(u,{type:"danger",link:"",onClick:B=>b(p.row.id)},{default:n(()=>[g("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[$,a.loading]]),t(s,{"current-page":a.page.current,"page-size":a.page.pageSize,"page-sizes":[10,20,50,100,200],total:a.page.total,layout:"total,sizes,prev,pager,next,jumper",onSizeChange:f,onCurrentChange:d},null,8,["current-page","page-size","total"]),t(K,{ref_key:"addOrEditRef",ref:y,onRefreshPage:r},null,512)]),_:1})}}});export{H as default};
