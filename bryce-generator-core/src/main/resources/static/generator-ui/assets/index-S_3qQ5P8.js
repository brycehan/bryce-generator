import{d as q,r as V,a as S,b as s,c as x,o as z,w as a,e as t,m as B,i as _,E as $,q as U,s as E,t as I,v as O,x as R}from"./index-CuHfYZIc.js";import{g as M,s as P,p as T,d as D}from"./baseClass-BKPGfC93.js";import"./request-ChiGirky.js";const K=q({__name:"add-or-edit",emits:["refreshPage"],setup(F,{expose:o,emit:b}){const p=b,c=V(!1),v=V(),n=S({id:"",code:"",packageName:"",fields:"",remark:""}),k=S({code:[{required:!0,message:"必填项不能为空",trigger:"blur"}],packageName:[{required:!0,message:"必填项不能为空",trigger:"blur"}],fields:[{required:!0,message:"必填项不能为空",trigger:"blur"}]}),C=i=>{c.value=!0,n.id="",v.value&&v.value.resetFields(),i&&r(i)},r=i=>{M(i).then(l=>{Object.assign(n,l.data)})},e=()=>{v.value.validate(i=>{if(!i)return!1;P(n).then(()=>{c.value=!1,p("refreshPage"),$.success("操作成功")})})};return o({init:C}),(i,l)=>{const u=s("el-input"),m=s("el-form-item"),g=s("el-form"),y=s("el-button"),w=s("el-dialog");return z(),x(w,{modelValue:c.value,"onUpdate:modelValue":l[7]||(l[7]=d=>c.value=d),title:n.id?"修改":"新增","close-on-click-modal":!1},{footer:a(()=>[t(y,{onClick:l[5]||(l[5]=d=>c.value=!1)},{default:a(()=>l[8]||(l[8]=[_("取消")])),_:1}),t(y,{type:"primary",onClick:l[6]||(l[6]=d=>e())},{default:a(()=>l[9]||(l[9]=[_("确定")])),_:1})]),default:a(()=>[t(g,{ref_key:"dataFormRef",ref:v,model:n,rules:k,"label-width":"120",onKeyup:l[4]||(l[4]=B(d=>e(),["enter"]))},{default:a(()=>[t(m,{label:"基类编码",prop:"code"},{default:a(()=>[t(u,{modelValue:n.code,"onUpdate:modelValue":l[0]||(l[0]=d=>n.code=d),placeholder:"基类编码"},null,8,["modelValue"])]),_:1}),t(m,{label:"基类包名",prop:"packageName"},{default:a(()=>[t(u,{modelValue:n.packageName,"onUpdate:modelValue":l[1]||(l[1]=d=>n.packageName=d),placeholder:"基类包名"},null,8,["modelValue"])]),_:1}),t(m,{label:"基类字段",prop:"fields"},{default:a(()=>[t(u,{modelValue:n.fields,"onUpdate:modelValue":l[2]||(l[2]=d=>n.fields=d),placeholder:"基类字段（多个字段，用英文逗号分隔）"},null,8,["modelValue"])]),_:1}),t(m,{label:"备注",prop:"remark"},{default:a(()=>[t(u,{modelValue:n.remark,"onUpdate:modelValue":l[3]||(l[3]=d=>n.remark=d),placeholder:"备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),H=q({__name:"index",setup(F){const o=S({queryForm:{code:""},page:{current:1,pageSize:10,total:0,orderItems:[{column:"createTime",asc:!1}]},data:[],dataSelections:[],loading:!1}),b=V();U(()=>{p()});const p=(r=1,e)=>{o.page.current=r,e!==void 0&&(o.page.pageSize=e),o.loading=!0;const i={current:o.page.current,pageSize:o.page.pageSize,orderItems:o.page.orderItems,...o.queryForm};T(i).then(l=>{const{list:u,total:m}=l.data;o.data=u,o.page.total=m}),o.loading=!1},c=r=>{p(1,r)},v=r=>{p(r)},n=r=>{b.value.init(r)},k=r=>{let e=[];if(r)e=[r];else if(e=o.dataSelections?o.dataSelections:[],e.length===0){$.warning("请选择删除的记录");return}R.confirm("确定进行删除操作？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{D(e).then(()=>{$.success("删除成功"),p()})}).catch(i=>{console.error(i)})},C=r=>{o.dataSelections=r.map(e=>e.id)};return(r,e)=>{const i=s("el-input"),l=s("el-form-item"),u=s("el-button"),m=s("el-form"),g=s("el-table-column"),y=s("el-table"),w=s("el-pagination"),d=s("el-card"),h=E("loading");return z(),x(d,{shadow:"hover"},{default:a(()=>[t(m,{inline:!0,model:o.queryForm,onKeyup:e[4]||(e[4]=B(f=>p(),["enter"])),onSubmit:e[5]||(e[5]=O(()=>{},["prevent"]))},{default:a(()=>[t(l,null,{default:a(()=>[t(i,{modelValue:o.queryForm.code,"onUpdate:modelValue":e[0]||(e[0]=f=>o.queryForm.code=f),placeholder:"基类编码",clearable:""},null,8,["modelValue"])]),_:1}),t(l,null,{default:a(()=>[t(u,{onClick:e[1]||(e[1]=f=>p())},{default:a(()=>e[6]||(e[6]=[_("查询")])),_:1}),t(u,{type:"primary",onClick:e[2]||(e[2]=f=>n())},{default:a(()=>e[7]||(e[7]=[_("新增")])),_:1}),t(u,{type:"danger",onClick:e[3]||(e[3]=f=>k())},{default:a(()=>e[8]||(e[8]=[_("删除")])),_:1})]),_:1})]),_:1},8,["model"]),I((z(),x(y,{data:o.data,border:!0,style:{width:"100%"},onSelectionChange:C},{default:a(()=>[t(g,{type:"selection","header-align":"center",align:"center",width:"50"}),t(g,{label:"基类编码",prop:"code","header-align":"center",align:"center"}),t(g,{label:"基类包名",prop:"packageName","show-overflow-tooltip":"","header-align":"center",align:"center"}),t(g,{label:"基类字段",prop:"fields","show-overflow-tooltip":"","header-align":"center",align:"center"}),t(g,{label:"备注",prop:"remark","show-overflow-tooltip":"","header-align":"center",align:"center"}),t(g,{label:"操作",fixed:"right","header-align":"center",align:"center",width:"150"},{default:a(f=>[t(u,{type:"primary",link:"",onClick:N=>n(f.row.id)},{default:a(()=>e[9]||(e[9]=[_("编辑")])),_:2},1032,["onClick"]),t(u,{type:"danger",link:"",onClick:N=>k(f.row.id)},{default:a(()=>e[10]||(e[10]=[_("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[h,o.loading]]),t(w,{"current-page":o.page.current,"page-size":o.page.pageSize,"page-sizes":[10,20,50,100,200],total:o.page.total,layout:"total,sizes,prev,pager,next,jumper",onSizeChange:c,onCurrentChange:v},null,8,["current-page","page-size","total"]),t(K,{ref_key:"addOrEditRef",ref:b,onRefreshPage:p},null,512)]),_:1})}}});export{H as default};
