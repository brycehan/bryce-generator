import{d as x,r as C,a as V,b as i,o as h,c as S,w as n,e as t,f as g,m as F,E as w,q as N,s as U,t as E,v as I,x as O}from"./index-c2c98dd5.js";import{g as R,s as M,p as P,d as D}from"./fieldType-fd1d14f6.js";import"./request-e59313c2.js";const K=x({__name:"add-or-edit",emits:["refreshPage"],setup(q,{expose:l,emit:y}){const r=C(!1),f=C(),d=V({id:"",columnType:"",attrType:"",packageName:"",createTime:""}),v=V({columnType:[{required:!0,message:"必填项不能为空",trigger:"blur"}],attrType:[{required:!0,message:"必填项不能为空",trigger:"blur"}]}),b=e=>{r.value=!0,d.id="",f.value&&f.value.resetFields(),e&&T(e)},T=e=>{R(e).then(a=>{Object.assign(d,a.data)})},o=()=>{f.value.validate(e=>{if(!e)return!1;M(d).then(()=>{r.value=!1,y("refreshPage"),w.success("操作成功")})})};return l({init:b}),(e,a)=>{const m=i("el-input"),s=i("el-form-item"),_=i("el-form"),c=i("el-button"),k=i("el-dialog");return h(),S(k,{modelValue:r.value,"onUpdate:modelValue":a[6]||(a[6]=u=>r.value=u),title:d.id?"修改":"新增","close-on-click-modal":!1},{footer:n(()=>[t(c,{onClick:a[4]||(a[4]=u=>r.value=!1)},{default:n(()=>[g("取消")]),_:1}),t(c,{type:"primary",onClick:a[5]||(a[5]=u=>o())},{default:n(()=>[g("确定")]),_:1})]),default:n(()=>[t(_,{ref_key:"dataFormRef",ref:f,model:d,rules:v,"label-width":"120px",onKeyup:a[3]||(a[3]=F(u=>o(),["enter"]))},{default:n(()=>[t(s,{label:"字段类型",prop:"columnType"},{default:n(()=>[t(m,{modelValue:d.columnType,"onUpdate:modelValue":a[0]||(a[0]=u=>d.columnType=u),placeholder:"字段类型"},null,8,["modelValue"])]),_:1}),t(s,{label:"属性类型",prop:"attrType"},{default:n(()=>[t(m,{modelValue:d.attrType,"onUpdate:modelValue":a[1]||(a[1]=u=>d.attrType=u),placeholder:"属性类型"},null,8,["modelValue"])]),_:1}),t(s,{label:"属性包名",prop:"packageName"},{default:n(()=>[t(m,{modelValue:d.packageName,"onUpdate:modelValue":a[2]||(a[2]=u=>d.packageName=u),placeholder:"属性包名"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),H=x({__name:"index",setup(q){const l=V({queryForm:{columnType:"",attrType:"",packageName:""},page:{current:1,pageSize:10,total:0,orderItems:[{column:"createTime",asc:!1}]},data:[],dataSelections:[],loading:!1}),y=C();N(()=>{r()});const r=(o=1,e)=>{l.page.current=o,e!==void 0&&(l.page.pageSize=e),l.loading=!0;const a={current:l.page.current,pageSize:l.page.pageSize,orderItems:l.page.orderItems,...l.queryForm};P(a).then(m=>{const{list:s,total:_}=m.data;l.data=s,l.page.total=_}),l.loading=!1},f=o=>{r(1,o)},d=o=>{r(o)},v=o=>{y.value.init(o)},b=o=>{let e=[];if(o)e=[o];else if(e=l.dataSelections?l.dataSelections:[],e.length===0){w.warning("请选择删除的记录");return}O.confirm("确定进行删除操作？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{D(e).then(()=>{w.success("删除成功"),r()})}).catch(a=>{console.error(a)})},T=o=>{l.dataSelections=o.map(e=>e.id)};return(o,e)=>{const a=i("el-input"),m=i("el-form-item"),s=i("el-button"),_=i("el-form"),c=i("el-table-column"),k=i("el-table"),u=i("el-pagination"),z=i("el-card"),$=U("loading");return h(),S(z,{shadow:"hover"},{default:n(()=>[t(_,{inline:!0,model:l.queryForm,onKeyup:e[5]||(e[5]=F(p=>r(),["enter"])),onSubmit:e[6]||(e[6]=E(()=>{},["prevent"]))},{default:n(()=>[t(m,null,{default:n(()=>[t(a,{modelValue:l.queryForm.columnType,"onUpdate:modelValue":e[0]||(e[0]=p=>l.queryForm.columnType=p),placeholder:"字段类型"},null,8,["modelValue"])]),_:1}),t(m,null,{default:n(()=>[t(a,{modelValue:l.queryForm.attrType,"onUpdate:modelValue":e[1]||(e[1]=p=>l.queryForm.attrType=p),placeholder:"属性类型"},null,8,["modelValue"])]),_:1}),t(m,null,{default:n(()=>[t(s,{onClick:e[2]||(e[2]=p=>r())},{default:n(()=>[g("查询")]),_:1}),t(s,{type:"primary",onClick:e[3]||(e[3]=p=>v())},{default:n(()=>[g("新增")]),_:1}),t(s,{type:"danger",onClick:e[4]||(e[4]=p=>b())},{default:n(()=>[g("删除")]),_:1})]),_:1})]),_:1},8,["model"]),I((h(),S(k,{data:l.data,border:!0,style:{width:"100%"},onSelectionChange:T},{default:n(()=>[t(c,{type:"selection","header-align":"center",align:"center",width:"50"}),t(c,{label:"字段类型",prop:"columnType","header-align":"center",align:"center"}),t(c,{label:"属性类型",prop:"attrType","header-align":"center",align:"center"}),t(c,{label:"属性包名",prop:"packageName","header-align":"center",align:"center"}),t(c,{label:"操作",fixed:"right","header-align":"center",align:"center",width:"150"},{default:n(p=>[t(s,{type:"primary",link:"",onClick:B=>v(p.row.id)},{default:n(()=>[g("编辑")]),_:2},1032,["onClick"]),t(s,{type:"danger",link:"",onClick:B=>b(p.row.id)},{default:n(()=>[g("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[$,l.loading]]),t(u,{"current-page":l.page.current,"page-size":l.page.pageSize,"page-sizes":[10,20,50,100,200],total:l.page.total,layout:"total,sizes,prev,pager,next,jumper",onSizeChange:f,onCurrentChange:d},null,8,["current-page","page-size","total"]),t(K,{ref_key:"addOrEditRef",ref:y,onRefreshPage:r},null,512)]),_:1})}}});export{H as default};
