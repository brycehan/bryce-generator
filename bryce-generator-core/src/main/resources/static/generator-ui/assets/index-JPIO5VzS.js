import{d as q,r as V,a as S,b as i,c as w,o as x,w as n,e as t,m as z,i as y,E as F,q as U,s as E,t as I,v as O,x as R}from"./index-CuHfYZIc.js";import{g as h,s as M,p as P,d as D}from"./fieldType-ctjBR38t.js";import"./request-ChiGirky.js";const K=q({__name:"add-or-edit",emits:["refreshPage"],setup($,{expose:a,emit:v}){const m=v,g=V(!1),_=V(),r=S({id:"",columnType:"",attrType:"",packageName:"",createTime:""}),b=S({columnType:[{required:!0,message:"必填项不能为空",trigger:"blur"}],attrType:[{required:!0,message:"必填项不能为空",trigger:"blur"}]}),k=d=>{g.value=!0,r.id="",_.value&&_.value.resetFields(),d&&o(d)},o=d=>{h(d).then(l=>{Object.assign(r,l.data)})},e=()=>{_.value.validate(d=>{if(!d)return!1;M(r).then(()=>{g.value=!1,m("refreshPage"),F.success("操作成功")})})};return a({init:k}),(d,l)=>{const u=i("el-input"),f=i("el-form-item"),c=i("el-form"),T=i("el-button"),C=i("el-dialog");return x(),w(C,{modelValue:g.value,"onUpdate:modelValue":l[6]||(l[6]=s=>g.value=s),title:r.id?"修改":"新增","close-on-click-modal":!1},{footer:n(()=>[t(T,{onClick:l[4]||(l[4]=s=>g.value=!1)},{default:n(()=>l[7]||(l[7]=[y("取消")])),_:1}),t(T,{type:"primary",onClick:l[5]||(l[5]=s=>e())},{default:n(()=>l[8]||(l[8]=[y("确定")])),_:1})]),default:n(()=>[t(c,{ref_key:"dataFormRef",ref:_,model:r,rules:b,"label-width":"120",onKeyup:l[3]||(l[3]=z(s=>e(),["enter"]))},{default:n(()=>[t(f,{label:"字段类型",prop:"columnType"},{default:n(()=>[t(u,{modelValue:r.columnType,"onUpdate:modelValue":l[0]||(l[0]=s=>r.columnType=s),placeholder:"字段类型"},null,8,["modelValue"])]),_:1}),t(f,{label:"属性类型",prop:"attrType"},{default:n(()=>[t(u,{modelValue:r.attrType,"onUpdate:modelValue":l[1]||(l[1]=s=>r.attrType=s),placeholder:"属性类型"},null,8,["modelValue"])]),_:1}),t(f,{label:"属性包名",prop:"packageName"},{default:n(()=>[t(u,{modelValue:r.packageName,"onUpdate:modelValue":l[2]||(l[2]=s=>r.packageName=s),placeholder:"属性包名"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),H=q({__name:"index",setup($){const a=S({queryForm:{columnType:"",attrType:"",packageName:""},page:{current:1,pageSize:10,total:0,orderItems:[{column:"createTime",asc:!1}]},data:[],dataSelections:[],loading:!1}),v=V();U(()=>{m()});const m=(o=1,e)=>{a.page.current=o,e!==void 0&&(a.page.pageSize=e),a.loading=!0;const d={current:a.page.current,pageSize:a.page.pageSize,orderItems:a.page.orderItems,...a.queryForm};P(d).then(l=>{const{list:u,total:f}=l.data;a.data=u,a.page.total=f}),a.loading=!1},g=o=>{m(1,o)},_=o=>{m(o)},r=o=>{v.value.init(o)},b=o=>{let e=[];if(o)e=[o];else if(e=a.dataSelections?a.dataSelections:[],e.length===0){F.warning("请选择删除的记录");return}R.confirm("确定进行删除操作？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{D(e).then(()=>{F.success("删除成功"),m()})}).catch(d=>{console.error(d)})},k=o=>{a.dataSelections=o.map(e=>e.id)};return(o,e)=>{const d=i("el-input"),l=i("el-form-item"),u=i("el-button"),f=i("el-form"),c=i("el-table-column"),T=i("el-table"),C=i("el-pagination"),s=i("el-card"),B=E("loading");return x(),w(s,{shadow:"hover"},{default:n(()=>[t(f,{inline:!0,model:a.queryForm,onKeyup:e[5]||(e[5]=z(p=>m(),["enter"])),onSubmit:e[6]||(e[6]=O(()=>{},["prevent"]))},{default:n(()=>[t(l,null,{default:n(()=>[t(d,{modelValue:a.queryForm.columnType,"onUpdate:modelValue":e[0]||(e[0]=p=>a.queryForm.columnType=p),placeholder:"字段类型",clearable:""},null,8,["modelValue"])]),_:1}),t(l,null,{default:n(()=>[t(d,{modelValue:a.queryForm.attrType,"onUpdate:modelValue":e[1]||(e[1]=p=>a.queryForm.attrType=p),placeholder:"属性类型",clearable:""},null,8,["modelValue"])]),_:1}),t(l,null,{default:n(()=>[t(u,{onClick:e[2]||(e[2]=p=>m())},{default:n(()=>e[7]||(e[7]=[y("查询")])),_:1}),t(u,{type:"primary",onClick:e[3]||(e[3]=p=>r())},{default:n(()=>e[8]||(e[8]=[y("新增")])),_:1}),t(u,{type:"danger",onClick:e[4]||(e[4]=p=>b())},{default:n(()=>e[9]||(e[9]=[y("删除")])),_:1})]),_:1})]),_:1},8,["model"]),I((x(),w(T,{data:a.data,border:!0,style:{width:"100%"},onSelectionChange:k},{default:n(()=>[t(c,{type:"selection","header-align":"center",align:"center",width:"50"}),t(c,{label:"字段类型",prop:"columnType","header-align":"center",align:"center"}),t(c,{label:"属性类型",prop:"attrType","header-align":"center",align:"center"}),t(c,{label:"属性包名",prop:"packageName","header-align":"center",align:"center"}),t(c,{label:"操作",fixed:"right","header-align":"center",align:"center",width:"150"},{default:n(p=>[t(u,{type:"primary",link:"",onClick:N=>r(p.row.id)},{default:n(()=>e[10]||(e[10]=[y("编辑")])),_:2},1032,["onClick"]),t(u,{type:"danger",link:"",onClick:N=>b(p.row.id)},{default:n(()=>e[11]||(e[11]=[y("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[B,a.loading]]),t(C,{"current-page":a.page.current,"page-size":a.page.pageSize,"page-sizes":[10,20,50,100,200],total:a.page.total,layout:"total,sizes,prev,pager,next,jumper",onSizeChange:g,onCurrentChange:_},null,8,["current-page","page-size","total"]),t(K,{ref_key:"addOrEditRef",ref:v,onRefreshPage:m},null,512)]),_:1})}}});export{H as default};
