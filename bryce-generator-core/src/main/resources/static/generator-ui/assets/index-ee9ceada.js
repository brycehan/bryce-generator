import{d as z,r as C,a as w,b as s,o as V,c as S,w as o,e as t,f as g,m as $,E as x,q as U,s as E,t as I,v as O,x as R}from"./index-7b584818.js";import{g as M,s as P,p as T,d as D}from"./baseClass-005f3edc.js";import"./request-e217e25d.js";const K=z({__name:"add-or-edit",emits:["refreshPage"],setup(q,{expose:a,emit:v}){const i=C(!1),f=C(),r=w({id:"",code:"",packageName:"",fields:"",remark:""}),b=w({code:[{required:!0,message:"必填项不能为空",trigger:"blur"}],packageName:[{required:!0,message:"必填项不能为空",trigger:"blur"}],fields:[{required:!0,message:"必填项不能为空",trigger:"blur"}]}),k=e=>{i.value=!0,r.id="",f.value&&f.value.resetFields(),e&&y(e)},y=e=>{M(e).then(l=>{Object.assign(r,l.data)})},n=()=>{f.value.validate(e=>{if(!e)return!1;P(r).then(()=>{x.success({message:"操作成功",duration:500,onClose:()=>{i.value=!1,v("refreshPage")}})})})};return a({init:k}),(e,l)=>{const p=s("el-input"),u=s("el-form-item"),_=s("el-form"),m=s("el-button"),h=s("el-dialog");return V(),S(h,{modelValue:i.value,"onUpdate:modelValue":l[7]||(l[7]=d=>i.value=d),title:r.id?"修改":"新增","close-on-click-modal":!1},{footer:o(()=>[t(m,{onClick:l[5]||(l[5]=d=>i.value=!1)},{default:o(()=>[g("取消")]),_:1}),t(m,{type:"primary",onClick:l[6]||(l[6]=d=>n())},{default:o(()=>[g("确定")]),_:1})]),default:o(()=>[t(_,{ref_key:"dataFormRef",ref:f,model:r,rules:b,"label-width":"120px",onKeyup:l[4]||(l[4]=$(d=>n(),["enter"]))},{default:o(()=>[t(u,{label:"基类编码",prop:"code"},{default:o(()=>[t(p,{modelValue:r.code,"onUpdate:modelValue":l[0]||(l[0]=d=>r.code=d),placeholder:"基类编码"},null,8,["modelValue"])]),_:1}),t(u,{label:"基类包名",prop:"packageName"},{default:o(()=>[t(p,{modelValue:r.packageName,"onUpdate:modelValue":l[1]||(l[1]=d=>r.packageName=d),placeholder:"基类包名"},null,8,["modelValue"])]),_:1}),t(u,{label:"基类字段",prop:"fields"},{default:o(()=>[t(p,{modelValue:r.fields,"onUpdate:modelValue":l[2]||(l[2]=d=>r.fields=d),placeholder:"基类字段（多个字段，用英文逗号分隔）"},null,8,["modelValue"])]),_:1}),t(u,{label:"备注",prop:"remark"},{default:o(()=>[t(p,{modelValue:r.remark,"onUpdate:modelValue":l[3]||(l[3]=d=>r.remark=d),placeholder:"备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),H=z({__name:"index",setup(q){const a=w({queryForm:{code:""},page:{current:1,pageSize:10,total:0,orderItems:[{column:"createTime",asc:!1}]},data:[],dataSelections:[],loading:!1}),v=C();U(()=>{i()});const i=(n=1,e)=>{a.page.current=n,e!==void 0&&(a.page.pageSize=e),a.loading=!0;const l={current:a.page.current,pageSize:a.page.pageSize,orderItems:a.page.orderItems,...a.queryForm};T(l).then(p=>{const{list:u,total:_}=p.data;a.data=u,a.page.total=_}),a.loading=!1},f=n=>{i(1,n)},r=n=>{i(n)},b=n=>{v.value.init(n)},k=n=>{let e=[];if(n)e=[n];else if(e=a.dataSelections?a.dataSelections:[],e.length===0){x.warning("请选择删除的记录");return}R.confirm("确定进行删除操作？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{D(e).then(()=>{x.success("删除成功"),i()})}).catch(l=>{console.error(l)})},y=n=>{a.dataSelections=n.map(e=>e.id)};return(n,e)=>{const l=s("el-input"),p=s("el-form-item"),u=s("el-button"),_=s("el-form"),m=s("el-table-column"),h=s("el-table"),d=s("el-pagination"),B=s("el-card"),F=E("loading");return V(),S(B,{shadow:"hover"},{default:o(()=>[t(_,{inline:!0,model:a.queryForm,onKeyup:e[4]||(e[4]=$(c=>i(),["enter"])),onSubmit:e[5]||(e[5]=I(()=>{},["prevent"]))},{default:o(()=>[t(p,null,{default:o(()=>[t(l,{modelValue:a.queryForm.code,"onUpdate:modelValue":e[0]||(e[0]=c=>a.queryForm.code=c),placeholder:"基类编码"},null,8,["modelValue"])]),_:1}),t(p,null,{default:o(()=>[t(u,{onClick:e[1]||(e[1]=c=>i())},{default:o(()=>[g("查询")]),_:1}),t(u,{type:"primary",onClick:e[2]||(e[2]=c=>b())},{default:o(()=>[g("新增")]),_:1}),t(u,{type:"danger",onClick:e[3]||(e[3]=c=>k())},{default:o(()=>[g("删除")]),_:1})]),_:1})]),_:1},8,["model"]),O((V(),S(h,{data:a.data,border:!0,style:{width:"100%"},onSelectionChange:y},{default:o(()=>[t(m,{type:"selection","header-align":"center",align:"center",width:"50"}),t(m,{label:"基类编码",prop:"code","header-align":"center",align:"center"}),t(m,{label:"基类包名",prop:"packageName","show-overflow-tooltip":"","header-align":"center",align:"center"}),t(m,{label:"基类字段",prop:"fields","show-overflow-tooltip":"","header-align":"center",align:"center"}),t(m,{label:"备注",prop:"remark","show-overflow-tooltip":"","header-align":"center",align:"center"}),t(m,{label:"操作",fixed:"right","header-align":"center",align:"center",width:"150"},{default:o(c=>[t(u,{type:"primary",link:"",onClick:N=>b(c.row.id)},{default:o(()=>[g("编辑")]),_:2},1032,["onClick"]),t(u,{type:"danger",link:"",onClick:N=>k(c.row.id)},{default:o(()=>[g("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[F,a.loading]]),t(d,{"current-page":a.page.current,"page-size":a.page.pageSize,"page-sizes":[10,20,50,100,200],total:a.page.total,layout:"total,sizes,prev,pager,next,jumper",onSizeChange:f,onCurrentChange:r},null,8,["current-page","page-size","total"]),t(K,{ref_key:"addOrEditRef",ref:v,onRefreshPage:i},null,512)]),_:1})}}});export{H as default};
